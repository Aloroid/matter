<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Loop | matter</title><meta data-react-helmet="true" property="og:title" content="Loop | matter"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="description" content="The Loop class handles scheduling and *looping* (who would have guessed) over all of your game systems."><meta data-react-helmet="true" property="og:description" content="The Loop class handles scheduling and *looping* (who would have guessed) over all of your game systems."><meta data-react-helmet="true" property="og:url" content="https://eryn.io/matter/api/Loop"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="canonical" href="https://eryn.io/matter/api/Loop"><link data-react-helmet="true" rel="alternate" href="https://eryn.io/matter/api/Loop" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://eryn.io/matter/api/Loop" hreflang="x-default"><link rel="stylesheet" href="/matter/assets/css/styles.ea555ebc.css">
<link rel="preload" href="/matter/assets/js/runtime~main.e86ed830.js" as="script">
<link rel="preload" href="/matter/assets/js/main.813414f1.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/matter/"><b class="navbar__title">matter</b></a><a class="navbar__item navbar__link" href="/matter/docs/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/matter/api/">API</a></div><div class="navbar__items navbar__items--right"><a href="https://discord.gg/aQwDAYhqtJ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Roblox Open Source Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/evaera/matter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Press S to Search..." aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docPageContainer_3ccu"><div class="docPage_8QDt"><div class="docSidebarContainer_1Ern"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/Matter">â€‹Matter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/World">â€‹World</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/QueryResult">â€‹Queryâ€‹Result</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/matter/api/Loop">â€‹Loop</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/matter/api/Component">â€‹Component</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_27Zo"><div class="container padding-vert--lg"><div class="row"><div class="col docItemCol_N2vh"><div class="docItemContainer_3H03"><article><div class="member_2635 markdown"><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_30Sy"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><header><h1 class="docTitle_GF7h" style="text-decoration:none"><span style="display:inline-block">Loop</span></h1><div class="luaClassTags_Ddhq"></div><div>
<p>The Loop class handles scheduling and <em>looping</em> (who would have guessed) over all of your game systems.</p>
</div></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="types">Types<a aria-hidden="true" class="hash-link" href="#types" title="Direct link to heading">â€‹</a></h2><div class="divider_wJfn"></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="System"><code style="text-decoration:none">System</code><a aria-hidden="true" class="hash-link" href="#System" title="Direct link to heading">â€‹</a></h3><div class="repositoryDetailsContainer_1YsL"><a class="sourceButton_3Nc5" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L67"><div class="sourceButtonText_B34l">&lt;/&gt;</div></a></div><div class="memberString_2_bn"><code class="purple_3km9">type</code> <code>System<!-- --> = </code> <code class="blue_1B1Q"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#SystemTable">SystemTable</a></code><code class="op_EBMF">Â |Â </code><code class="green_K7bQ">(</code><code class="blue_1B1Q">...any</code><code class="green_K7bQ">)</code><code class="green_K7bQ">Â â†’Â </code><code class="green_K7bQ">(</code><code class="green_K7bQ">)</code></div><div>
<p>Either a plain function or a table defining the system.</p>
</div><div class="divider_wJfn"></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="SystemTable"><code style="text-decoration:none">SystemTable</code><a aria-hidden="true" class="hash-link" href="#SystemTable" title="Direct link to heading">â€‹</a></h3><div class="repositoryDetailsContainer_1YsL"><a class="sourceButton_3Nc5" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L81"><div class="sourceButtonText_B34l">&lt;/&gt;</div></a></div><div class="memberString_2_bn"><code class="purple_3km9">interface</code> <code>SystemTable<!-- --> <!-- -->{</code><div class="inset_2aGl"><div><code>system<!-- -->:Â </code><code class="green_K7bQ">(</code><code class="blue_1B1Q">...any</code><code class="green_K7bQ">)</code><code class="green_K7bQ">Â â†’Â </code><code class="green_K7bQ">(</code><code class="green_K7bQ">)</code><span class="inlineDescription_30X9">-- <span>
<p>The system function</p>
</span></span></div><div><code>event?<!-- -->:Â </code><code class="blue_1B1Q">string</code><span class="inlineDescription_30X9">-- <span>
<p>The event the system runs on. A string, a key from the table you pass to <code>Loop:begin</code>.</p>
</span></span></div><div><code>priority?<!-- -->:Â </code><code class="blue_1B1Q">number</code><span class="inlineDescription_30X9">-- <span>
<p>Priority influences the position in the frame the system is scheduled to run at.</p>
</span></span></div><div><code>after?<!-- -->:Â </code><code class="op_EBMF">{</code><code class="blue_1B1Q"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#System">System</a></code><code class="op_EBMF">}</code><span class="inlineDescription_30X9">-- <span>
<p>A list of systems that this system must run after.</p>
</span></span></div></div><code>}</code></div><div>
<p>A table defining a system with possible options.</p>
<p>
  Systems are scheduled in order of <code>priority</code>, meaning lower <code>priority</code> runs first.
  The default priority is <code>0</code>.
</p>
</div><h2 class="anchor anchorWithStickyNavbar_31ik" id="functions">Functions<a aria-hidden="true" class="hash-link" href="#functions" title="Direct link to heading">â€‹</a></h2><div class="divider_wJfn"></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="new"><code style="text-decoration:none">new</code><a aria-hidden="true" class="hash-link" href="#new" title="Direct link to heading">â€‹</a></h3><div class="repositoryDetailsContainer_1YsL"><a class="sourceButton_3Nc5" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L50"><div class="sourceButtonText_B34l">&lt;/&gt;</div></a></div><div class="memberString_2_bn"><code>Loop<!-- -->.</code><code class="green_K7bQ">new</code><code>(</code><div class="inset_2aGl"><div><code>...<!-- -->:Â </code><code class="blue_1B1Q">...any</code><span class="inlineDescription_30X9">-- <span>
<p>Values that will be passed to all of your systems</p>
</span></span></div></div><code>) â†’Â </code><code class="blue_1B1Q"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop">Loop</a></code></div><div>
<p>Creates a new loop. <code>Loop.new</code> accepts as arguments the values that will be passed to all of your systems.</p>
<p>So typically, you want to pass the World in here, as well as maybe a table of global game state.</p>
<pre class="language-lua"><code class="language-lua"><span class="token keyword">local</span> world <span class="token operator">=</span> World<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">local</span> gameState <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">local</span> loop <span class="token operator">=</span> Loop<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>world<span class="token punctuation">,</span> gameState<span class="token punctuation">)</span>
</code></pre>
</div><div class="divider_wJfn"></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="scheduleSystems"><code style="text-decoration:none">scheduleSystems</code><a aria-hidden="true" class="hash-link" href="#scheduleSystems" title="Direct link to heading">â€‹</a></h3><div class="repositoryDetailsContainer_1YsL"><a class="sourceButton_3Nc5" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L121"><div class="sourceButtonText_B34l">&lt;/&gt;</div></a></div><div class="memberString_2_bn"><code>Loop<!-- -->:</code><code class="green_K7bQ">scheduleSystems</code><code>(</code><div class="inset_2aGl"><div><code>systems<!-- -->:Â </code><code class="op_EBMF">{</code><code class="blue_1B1Q"><a style="text-decoration:underline;color:inherit" href="/matter/api/Loop#System">System</a></code><code class="op_EBMF">}</code><span class="inlineDescription_30X9">-- <span>
<p>Array of systems to schedule.</p>
</span></span></div></div><code>) â†’Â </code><code>(</code><code>)</code></div><div>
<p>Schedules a set of systems based on the constraints they define.</p>
<p>Systems may optionally declare:</p>
<ul>
  <li>The name of the event they run on (e.g., RenderStepped, Stepped, Heartbeat)</li>
  <li>A numerical priority value</li>
  <li>Other systems that they must run <em>after</em></li>
</ul>
<p>If systems do not specify an event, they will run on the <code>default</code> event.</p>
<p>
  Systems that share an event will run in order of their priority, which means that systems with a lower <code>priority</code>
  value run first. The default priority is <code>0</code>.
</p>
<p>
  Systems that have defined what systems they run <code>after</code> can only be scheduled after all systems they depend on have
  already been scheduled.
</p>
<p>
  All else being equal, the order in which systems run is stable, meaning if you don't change your code, your systems
  will always run in the same order across machines.
</p>
<div class="admonition admonition-info alert alert--info">
  <div class="admonition-heading">
    <h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16">
          <path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path>
        </svg></span>info</h5>
  </div>
  <div class="admonition-content">
    <p>
      It is possible for your systems to be in an unresolvable state. In which case, <code>scheduleSystems</code> will error.
      This can happen when your systems have circular or unresolvable dependency chains.
    </p>
    <p>
      If a system has both a <code>priority</code> and defines systems it runs <code>after</code>, the system can only be scheduled if all of
      the systems it depends on have a lower or equal priority.
    </p>
    <p>
      Systems can never depend on systems that run on other events, because it is not guaranteed or required that events
      will fire every frame or will always fire in the same order.
    </p>
  </div>
</div>
<div class="admonition admonition-caution alert alert--warning">
  <div class="admonition-heading">
    <h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
          <path d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path>
        </svg></span>caution</h5>
  </div>
  <div class="admonition-content">
    <p>
      <code>scheduleSystems</code> has to perform nontrivial sorting work each time it's called, so you should avoid calling it multiple
      times if possible.
    </p>
  </div>
</div>
</div><div class="divider_wJfn"></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="begin"><code style="text-decoration:none">begin</code><a aria-hidden="true" class="hash-link" href="#begin" title="Direct link to heading">â€‹</a></h3><div class="repositoryDetailsContainer_1YsL"><a class="sourceButton_3Nc5" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L247"><div class="sourceButtonText_B34l">&lt;/&gt;</div></a></div><div class="memberString_2_bn"><code>Loop<!-- -->:</code><code class="green_K7bQ">begin</code><code>(</code><div class="inset_2aGl"><div><code>events<!-- -->:Â </code><code class="op_EBMF">{</code><span><code>[</code><code class="blue_1B1Q">string</code><code>]</code></span><code>:Â </code><code class="blue_1B1Q"><a style="text-decoration:underline;color:inherit" href="https://developer.roblox.com/en-us/api-reference/datatype/RBXScriptSignal" target="_blank" rel="noopener noreferrer">RBXScriptSignal<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" style="color:gray;vertical-align:middle;margin-left:2px"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></code><code class="op_EBMF">}</code><span class="inlineDescription_30X9">-- <span>
<p>A map from event name to event objects.</p>
</span></span></div></div><code>) â†’Â </code><code class="op_EBMF">{</code><span><code>[</code><code class="blue_1B1Q">string</code><code>]</code></span><code>:Â </code><code class="blue_1B1Q"><a style="text-decoration:underline;color:inherit" href="https://developer.roblox.com/en-us/api-reference/datatype/RBXScriptConnection" target="_blank" rel="noopener noreferrer">RBXScriptConnection<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" style="color:gray;vertical-align:middle;margin-left:2px"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></code><code class="op_EBMF">}</code><span class="inlineDescription_30X9">-- <span>
<p>A map from your event names to connection objects.</p>
</span></span></div><div>
<p>Connects to frame events and starts invoking your systems.</p>
<p>
  Pass a table of events you want to be able to run systems on, a map of name to event. Systems can use these names
  to define what event they run on. By default, systems run on an event named <code>"default"</code>. Custom events may be used
  if they have a <code>Connect</code> function.
</p>
<pre class="language-lua"><code class="language-lua">loop<span class="token punctuation">:</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	default <span class="token operator">=</span> RunService<span class="token punctuation">.</span>Heartbeat<span class="token punctuation">,</span>
	Heartbeat <span class="token operator">=</span> RunService<span class="token punctuation">.</span>Heartbeat<span class="token punctuation">,</span>
	RenderStepped <span class="token operator">=</span> RunService<span class="token punctuation">.</span>RenderStepped<span class="token punctuation">,</span>
	Stepped <span class="token operator">=</span> RunService<span class="token punctuation">.</span>Stepped<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Â </p>
<div class="admonition admonition-info alert alert--info">
  <div class="admonition-heading">
    <h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16">
          <path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path>
        </svg></span>info</h5>
  </div>
  <div class="admonition-content">
    <p>
      Events that do not have any systems scheduled to run on them <strong>at the time you call <code>Loop:begin</code></strong> will be skipped
      and never connected to. All systems should be scheduled before you call this function.
    </p>
  </div>
</div>
<p>
  Returns a table similar to the one you passed in, but the values are <code>RBXScriptConnection</code> values (or whatever is
  returned by <code>:Connect</code> if you passed in a synthetic event).
</p>
</div><div class="divider_wJfn"></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="addMiddleware"><code style="text-decoration:none">addMiddleware</code><a aria-hidden="true" class="hash-link" href="#addMiddleware" title="Direct link to heading">â€‹</a></h3><div class="repositoryDetailsContainer_1YsL"><a class="sourceButton_3Nc5" href="https://github.com/evaera/matter/blob/main/lib/Loop.lua#L374"><div class="sourceButtonText_B34l">&lt;/&gt;</div></a></div><div class="memberString_2_bn"><code>Loop<!-- -->:</code><code class="green_K7bQ">addMiddleware</code><code>(</code><code>middleware<!-- -->:Â </code><code class="green_K7bQ">(</code><code>nextFn<!-- -->:Â </code><code class="purple_3km9">(</code><code class="purple_3km9">)</code><code class="purple_3km9">Â â†’Â </code><code class="purple_3km9">(</code><code class="purple_3km9">)</code><code class="green_K7bQ">)</code><code class="green_K7bQ">Â â†’Â </code><code class="green_K7bQ">(</code><code class="green_K7bQ">)</code><code class="green_K7bQ">Â â†’Â </code><code class="green_K7bQ">(</code><code class="green_K7bQ">)</code><code>) â†’Â </code><code>(</code><code>)</code></div><div>
<p>Adds a user-defined middleware function that is called during each frame.</p>
<p>This allows you to run code before and after each frame, to perform initialization and cleanup work.</p>
<pre class="language-lua"><code class="language-lua">loop<span class="token punctuation">:</span><span class="token function">addMiddleware</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>nextFn<span class="token punctuation">)</span>
	<span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		Plasma<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span>plasmaNode<span class="token punctuation">,</span> nextFn<span class="token punctuation">)</span>
	<span class="token keyword">end</span>
<span class="token keyword">end</span><span class="token punctuation">)</span>
</code></pre>
<p>You must pass <code>addMiddleware</code> a function that itself returns a function that invokes <code>nextFn</code> at some point.</p>
<p>The outer function is invoked only once. The inner function is invoked during each frame event.</p>
<div class="admonition admonition-info alert alert--info">
  <div class="admonition-heading">
    <h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16">
          <path d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path>
        </svg></span>info</h5>
  </div>
  <div class="admonition-content">
    <p>
      Middleware added later "wraps" middleware that was added earlier. The innermost middleware function is the internal
      function that actually calls your systems.
    </p>
  </div>
</div>
</div></div></article></div><details><summary>Show raw api</summary><pre style="max-width:100%;white-space:pre-wrap">{
    &quot;functions&quot;: [
        {
            &quot;name&quot;: &quot;new&quot;,
            &quot;desc&quot;: &quot;Creates a new loop. `Loop.new` accepts as arguments the values that will be passed to all of your systems.\n\nSo typically, you want to pass the World in here, as well as maybe a table of global game state.\n\n```lua\nlocal world = World.new()\nlocal gameState = {}\n\nlocal loop = Loop.new(world, gameState)\n```&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;...&quot;,
                    &quot;desc&quot;: &quot;Values that will be passed to all of your systems&quot;,
                    &quot;lua_type&quot;: &quot;...any&quot;
                }
            ],
            &quot;returns&quot;: [
                {
                    &quot;desc&quot;: &quot;&quot;,
                    &quot;lua_type&quot;: &quot;Loop&quot;
                }
            ],
            &quot;function_type&quot;: &quot;static&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 50,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;scheduleSystems&quot;,
            &quot;desc&quot;: &quot;Schedules a set of systems based on the constraints they define.\n\nSystems may optionally declare:\n- The name of the event they run on (e.g., RenderStepped, Stepped, Heartbeat)\n- A numerical priority value\n- Other systems that they must run *after*\n\nIf systems do not specify an event, they will run on the `default` event.\n\nSystems that share an event will run in order of their priority, which means that systems with a lower `priority`\nvalue run first. The default priority is `0`.\n\nSystems that have defined what systems they run `after` can only be scheduled after all systems they depend on have\nalready been scheduled.\n\nAll else being equal, the order in which systems run is stable, meaning if you don&#x27;t change your code, your systems\nwill always run in the same order across machines.\n\n:::info\nIt is possible for your systems to be in an unresolvable state. In which case, `scheduleSystems` will error.\nThis can happen when your systems have circular or unresolvable dependency chains.\n\nIf a system has both a `priority` and defines systems it runs `after`, the system can only be scheduled if all of\nthe systems it depends on have a lower or equal priority.\n\nSystems can never depend on systems that run on other events, because it is not guaranteed or required that events\nwill fire every frame or will always fire in the same order.\n:::\n\n:::caution\n`scheduleSystems` has to perform nontrivial sorting work each time it&#x27;s called, so you should avoid calling it multiple\ntimes if possible.\n:::&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;systems&quot;,
                    &quot;desc&quot;: &quot;Array of systems to schedule.&quot;,
                    &quot;lua_type&quot;: &quot;{ System }&quot;
                }
            ],
            &quot;returns&quot;: [],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 121,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;begin&quot;,
            &quot;desc&quot;: &quot;Connects to frame events and starts invoking your systems.\n\nPass a table of events you want to be able to run systems on, a map of name to event. Systems can use these names\nto define what event they run on. By default, systems run on an event named `\&quot;default\&quot;`. Custom events may be used\nif they have a `Connect` function.\n\n```lua\nloop:begin({\n\tdefault = RunService.Heartbeat,\n\tHeartbeat = RunService.Heartbeat,\n\tRenderStepped = RunService.RenderStepped,\n\tStepped = RunService.Stepped,\n})\n```\n\n&amp;nbsp;\n\n:::info\nEvents that do not have any systems scheduled to run on them **at the time you call `Loop:begin`** will be skipped\nand never connected to. All systems should be scheduled before you call this function.\n:::\n\nReturns a table similar to the one you passed in, but the values are `RBXScriptConnection` values (or whatever is\nreturned by `:Connect` if you passed in a synthetic event).&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;events&quot;,
                    &quot;desc&quot;: &quot;A map from event name to event objects.&quot;,
                    &quot;lua_type&quot;: &quot;{[string]: RBXScriptSignal}&quot;
                }
            ],
            &quot;returns&quot;: [
                {
                    &quot;desc&quot;: &quot;A map from your event names to connection objects.&quot;,
                    &quot;lua_type&quot;: &quot;{[string]: RBXScriptConnection}&quot;
                }
            ],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 247,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;addMiddleware&quot;,
            &quot;desc&quot;: &quot;Adds a user-defined middleware function that is called during each frame.\n\nThis allows you to run code before and after each frame, to perform initialization and cleanup work.\n\n```lua\nloop:addMiddleware(function(nextFn)\n\treturn function()\n\t\tPlasma.start(plasmaNode, nextFn)\n\tend\nend)\n```\n\nYou must pass `addMiddleware` a function that itself returns a function that invokes `nextFn` at some point.\n\nThe outer function is invoked only once. The inner function is invoked during each frame event.\n\n:::info\nMiddleware added later \&quot;wraps\&quot; middleware that was added earlier. The innermost middleware function is the internal\nfunction that actually calls your systems.\n:::&quot;,
            &quot;params&quot;: [
                {
                    &quot;name&quot;: &quot;middleware&quot;,
                    &quot;desc&quot;: &quot;&quot;,
                    &quot;lua_type&quot;: &quot;(nextFn: () -&gt; ()) -&gt; () -&gt; ()&quot;
                }
            ],
            &quot;returns&quot;: [],
            &quot;function_type&quot;: &quot;method&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 374,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        }
    ],
    &quot;properties&quot;: [],
    &quot;types&quot;: [
        {
            &quot;name&quot;: &quot;System&quot;,
            &quot;desc&quot;: &quot;Either a plain function or a table defining the system.&quot;,
            &quot;lua_type&quot;: &quot;SystemTable | (...any) -&gt; ()&quot;,
            &quot;source&quot;: {
                &quot;line&quot;: 67,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        },
        {
            &quot;name&quot;: &quot;SystemTable&quot;,
            &quot;desc&quot;: &quot;A table defining a system with possible options.\n\nSystems are scheduled in order of `priority`, meaning lower `priority` runs first.\nThe default priority is `0`.&quot;,
            &quot;fields&quot;: [
                {
                    &quot;name&quot;: &quot;system&quot;,
                    &quot;lua_type&quot;: &quot;(...any) -&gt; ()&quot;,
                    &quot;desc&quot;: &quot;The system function&quot;
                },
                {
                    &quot;name&quot;: &quot;event?&quot;,
                    &quot;lua_type&quot;: &quot;string&quot;,
                    &quot;desc&quot;: &quot;The event the system runs on. A string, a key from the table you pass to `Loop:begin`.&quot;
                },
                {
                    &quot;name&quot;: &quot;priority?&quot;,
                    &quot;lua_type&quot;: &quot;number&quot;,
                    &quot;desc&quot;: &quot;Priority influences the position in the frame the system is scheduled to run at.&quot;
                },
                {
                    &quot;name&quot;: &quot;after?&quot;,
                    &quot;lua_type&quot;: &quot;{System}&quot;,
                    &quot;desc&quot;: &quot;A list of systems that this system must run after.&quot;
                }
            ],
            &quot;source&quot;: {
                &quot;line&quot;: 81,
                &quot;path&quot;: &quot;lib/Loop.lua&quot;
            }
        }
    ],
    &quot;name&quot;: &quot;Loop&quot;,
    &quot;desc&quot;: &quot;The Loop class handles scheduling and *looping* (who would have guessed) over all of your game systems.&quot;,
    &quot;source&quot;: {
        &quot;line&quot;: 32,
        &quot;path&quot;: &quot;lib/Loop.lua&quot;
    }
}</pre></details></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#types" class="table-of-contents__link toc-highlight">Types</a><ul><li><a href="#System" class="table-of-contents__link toc-highlight">System</a></li><li><a href="#SystemTable" class="table-of-contents__link toc-highlight">SystemTable</a></li></ul></li><li><a href="#properties" class="table-of-contents__link toc-highlight">Properties</a></li><li><a href="#functions" class="table-of-contents__link toc-highlight">Functions</a><ul><li><a href="#addMiddleware" class="table-of-contents__link toc-highlight">:addMiddleware</a></li><li><a href="#begin" class="table-of-contents__link toc-highlight">:begin</a></li><li><a href="#scheduleSystems" class="table-of-contents__link toc-highlight">:scheduleSystems</a></li><li><a href="#new" class="table-of-contents__link toc-highlight">.new</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 evaera. Built with Moonwave and Docusaurus.</div></div></div></footer></div>
<script src="/matter/assets/js/runtime~main.e86ed830.js"></script>
<script src="/matter/assets/js/main.813414f1.js"></script>
</body>
</html>